<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE HTML>
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
    <title>VA.MHV.PHR.EXAMPLE\Id vs Identifier - FHIR v4.0.1</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="author" content="http://hl7.org/fhir"/>

    <link href="fhir.css" rel="stylesheet"/>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap-fhir.css" rel="stylesheet"/>

    <!-- Project extras -->
    <link href="assets/css/project.css" rel="stylesheet"/>
    <link href="assets/css/pygments-manni.css" rel="stylesheet"/>
    <link href="assets/css/jquery-ui.css" rel="stylesheet"/>
  	<link href="assets/css/prism.css" rel="stylesheet" />
    <!-- Placeholder for child template CSS declarations -->
<link href="assets/css/vha-ig-template.css" rel="stylesheet"/>
<!-- Global site tag (gtag.js) - Google Analytics - Moehrke-Research-IGs -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GTLTM76GD7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-GTLTM76GD7');
</script>


    <script type="text/javascript" src="fhir-table-scripts.js"> </script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="assets/js/html5shiv.js"></script>
    <script src="assets/js/respond.min.js"></script>
    <![endif]-->

    <!-- Favicons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/ico/apple-touch-icon-144-precomposed.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/ico/apple-touch-icon-114-precomposed.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/ico/apple-touch-icon-72-precomposed.png"/>
    <link rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-57-precomposed.png"/>
    <link rel="shortcut icon" href="assets/ico/favicon.png"/>
  </head>
  <body onload="document.body.style.opacity='1'">

	  <script src="assets/js/prism.js"></script>

    <style type="text/css">h2{--heading-prefix:"5"}
    h3,h4,h5,h6{--heading-prefix:"5"}</style>
    <div id="segment-header" class="segment">  <!-- segment-header -->
      <div class="container">  <!-- container -->
        <!-- Placeholder for child template header declarations -->

<div id="jfm-nav"> 
     <a id="jfm-logo" no-external="true" href="https://johnmoehrke.github.io">
     <img height="50" alt="VA Organization" src="assets/images/va-header-logo.png"/>
     </a>
	 </div>

        <div id="ig-status">
          <p><span style="font-size:12pt;font-weight:bold">MyHealtheVet PHR FHIR API</span>
            <br/>
            <span style="display:inline-block;">0.1.12-beta - ci-build



  <img alt="United States of America flag" src="assets/images/usa.svg" height="16" title="United States of America"/>


            </span>
          </p>
        </div>
      </div> <!-- /container -->
    </div>  <!-- /segment-header -->

    <div id="segment-navbar" class="segment">  <!-- segment-navbar -->
      <div id="stripe"> </div>
      <div class="container">  <!-- container -->
        <!-- HEADER CONTENT -->

        <nav class="navbar navbar-inverse">
          <!--status-bar-->
          <div class="container">
            <button data-target=".navbar-inverse-collapse" class="navbar-toggle" data-toggle="collapse" type="button">
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
            </button>
            <a class="navbar-brand hidden" href="http://hl7.org/fhir/R4/index.html">FHIR</a>
            <div class="nav-collapse collapse navbar-inverse-collapse">
              <!-- menu.xml  -->

<ul xmlns="http://www.w3.org/1999/xhtml" class="nav navbar-nav">
  <li>
    <a href="index.html">Home</a>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Background
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="background.html">Introduction</a>
      </li>
      <li>
        <a href="utility.html">Utility</a>
      </li>
      <li>
        <a href="ConvertDate.html">ConvertDate</a>
      </li>
      <li>
        <a href="identifier.html">Id vs Identifier</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="testplan.html">Test Plan</a>
  </li>
  <li>
    <a href="artifacts.html">Artifacts</a>
  </li>
  <li>
    <a href="downloads.html">Downloads</a>
  </li>
</ul>
            </div>  <!-- /.nav-collapse -->
          </div>  <!-- /.container -->
        </nav>  <!-- /.navbar -->
      <!-- /HEADER CONTENT -->
      </div>  <!-- /container -->
    </div>  <!-- /segment-navbar -->
    <!--status-bar-->

    <div id="segment-breadcrumb" class="segment">  <!-- segment-breadcrumb -->
      <div class="container">  <!-- container -->
        <ul class="breadcrumb">
          <li><a href='toc.html'><b>Table of Contents</b></a></li><li><b>Id vs Identifier</b></li>

          <span style="float:right;">

            <a href="ConvertDate.html">&lt;prev</a> | 

            <a href="#bottom">bottom</a>

          | <a href="vitals.html">next&gt;</a>

          </span>

        </ul>
      </div>  <!-- /container -->
    </div>  <!-- /segment-breadcrumb -->

    <a name="top"> </a>
    <div id="segment-content" class="segment">  <!-- segment-content -->
      <div class="container">  <!-- container -->
        <div class="row">
          <div class="inner-wrapper">

<style type="text/css">
h2:before{color:silver;counter-increment:section;content:var(--heading-prefix) " ";}
h3:before{color:silver;counter-increment:sub-section;content:var(--heading-prefix) "." counter(sub-section) " ";}
h4:before{color:silver;counter-increment:composite;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) " ";}
h5:before{color:silver;counter-increment:detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) " ";}
h6:before{color:silver;counter-increment:more-detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) "." counter(more-detail)" ";}
</style>
<div class="col-12">
  <!--ReleaseHeader--><p id="publish-box">MyHealtheVet PHR FHIR API - Local Development build (v0.1.12-beta). See the <a href="https://johnmoehrke.github.io/MHV-PHR/history.html">Directory of published versions</a></p><!--EndReleaseHeader-->
  <h2>Id vs Identifier</h2>
  





  <table class="colsi">
    <tr>
  
      <td>
        <i>Page standards status:</i> <a href="http://hl7.org/fhir/R4/versions.html#std-process" title="Standard Status">Informative</a>
        
      </td>
  
  
    </tr>
  </table>








    <p><!-- white space is critical inside of capture --></p>
<div class="markdown-toc">
<ul id="markdown-toc">
  <li><a href="#encounter-id" id="markdown-toc-encounter-id">Encounter id</a></li>
  <li><a href="#accession-id" id="markdown-toc-accession-id">Accession id</a></li>
  <li><a href="#case-number" id="markdown-toc-case-number">Case Number</a></li>
  <li><a href="#organization" id="markdown-toc-organization">Organization</a></li>
</ul>

</div>

<p>Our FHIR database will track linkages to source objects using the FHIR resource <code class="language-plaintext highlighter-rouge">.identifier</code> element, and the Vista <code class="language-plaintext highlighter-rouge">.id</code> element.</p>

<ol>
  <li>As far as I can tell the <code class="language-plaintext highlighter-rouge">.id</code> values coming from Vista (Fileman) are given to us as strings. They are unique strings at the source for that given context of that data. (for a given Vista instance the ImmunizationTO.id is unique, but that id value might be a different ImmunizationTO object at a different Vista site, and that id value on a different object like NoteTO at the original Vista site)</li>
  <li>The <code class="language-plaintext highlighter-rouge">.id</code> values sometimes have a two or three part to them separated by <code class="language-plaintext highlighter-rouge">;</code>. I donâ€™t know if there is something we can interpret, or if I am just looking at non-real examples.</li>
  <li>In FHIR <a href="http://hl7.org/fhir/datatypes.html#Identifier">Identifier datatype</a> tend to be made up of two parts. The identifier value, and the system value within which that identifier value is known to be unique.</li>
  <li>Thus when we know the data received is from VDIF we can look up the given id as identifier of system+id.</li>
  <li>The VA CDA generation does a similar transform of the <code class="language-plaintext highlighter-rouge">.id</code> values into CDA <code class="language-plaintext highlighter-rouge">.id</code> values. We should use the same algorithm so that the same data is easily recognized regardless of if the data was received via CDA or our FHIR api. They do not transform all id values. Thus we should follow their lead where they have taken a lead so as to not create a de-duplication problem.</li>
  <li>The Lighthouse does not keep the id values in their FHIR output. So there is no precedent to follow.</li>
  <li>There is an OID directory for all facility OIDs. So there is a unique OID that can be used for each Vista instance.</li>
  <li><a href="https://oidref.com/2.16.840.1.113883.4.349">OID assigned to VA</a> <code class="language-plaintext highlighter-rouge">urn:oid:2.16.840.1.113883.4.349</code></li>
  <li>OID pattern for facilities is at <code class="language-plaintext highlighter-rouge">.4.{station number}</code>. There is a spreadsheet tracking all of the facility OIDs.</li>
</ol>

<p>Recommendation:</p>

<p>The <code class="language-plaintext highlighter-rouge">use</code> value will always be <code class="language-plaintext highlighter-rouge">usual</code></p>

<p>The <code class="language-plaintext highlighter-rouge">system</code> value is a fixed OID assigned to THAT Vista facility</p>

<p>the <code class="language-plaintext highlighter-rouge">value</code> is then composed of the id from the data plus (prefixed) identifier of the context datatype.</p>

<blockquote>
  <table>
    <tbody>
      <tr>
        <td>{context}</td>
        <td><code class="language-plaintext highlighter-rouge">.</code></td>
        <td>{id}</td>
      </tr>
    </tbody>
  </table>
</blockquote>

<p>Given that there is no need for a <code class="language-plaintext highlighter-rouge">value</code> to be numeric, we can just use the Vista datatype.</p>

<p>Context:</p>

<table class="grid">
  <thead>
    <tr>
      <th>Vista Datatype</th>
      <th>context prefix to use</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>UserTO.id</td>
      <td><code class="language-plaintext highlighter-rouge">UserTO</code></td>
    </tr>
    <tr>
      <td>PatientTO.id</td>
      <td><code class="language-plaintext highlighter-rouge">PatientTO</code></td>
    </tr>
    <tr>
      <td>AuthorTO.id</td>
      <td><code class="language-plaintext highlighter-rouge">AuthorTO</code></td>
    </tr>
    <tr>
      <td>HospitalLocationTO.id</td>
      <td><code class="language-plaintext highlighter-rouge">HospitalLocationTO</code></td>
    </tr>
    <tr>
      <td>AllergyTO.id</td>
      <td><code class="language-plaintext highlighter-rouge">AllergyTO</code></td>
    </tr>
    <tr>
      <td>ClinicalProcedureTO.id</td>
      <td><code class="language-plaintext highlighter-rouge">ClinicalProcedureTO</code></td>
    </tr>
    <tr>
      <td>VitalSignTO.id</td>
      <td><code class="language-plaintext highlighter-rouge">VitalSignTO</code></td>
    </tr>
    <tr>
      <td>ImmunizationTO.id</td>
      <td><code class="language-plaintext highlighter-rouge">ImmunizationTO</code></td>
    </tr>
    <tr>
      <td>NoteTO.id</td>
      <td><code class="language-plaintext highlighter-rouge">NoteTO</code></td>
    </tr>
    <tr>
      <td>LabReportTO.id</td>
      <td><code class="language-plaintext highlighter-rouge">LabReportTO</code></td>
    </tr>
    <tr>
      <td>LabReportTO.caseNumber</td>
      <td><code class="language-plaintext highlighter-rouge">LabReportTO.caseNumber</code></td>
    </tr>
    <tr>
      <td>LabSpecimenTO.id</td>
      <td><code class="language-plaintext highlighter-rouge">LabSpecimen</code></td>
    </tr>
    <tr>
      <td>LabResultTO.labSiteId</td>
      <td><code class="language-plaintext highlighter-rouge">labSiteId</code></td>
    </tr>
    <tr>
      <td>LabTestTO.id</td>
      <td><code class="language-plaintext highlighter-rouge">LabTestTO</code></td>
    </tr>
    <tr>
      <td>ImagingExamTO.id</td>
      <td><code class="language-plaintext highlighter-rouge">ImagingExamTO</code></td>
    </tr>
  </tbody>
</table>

<p>Thus for a ClinicalProcedureTO.id value of 1234 from site 989. (I assume 989 is a test site that shows up in the test data often)</p>

<p>example in json</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">"identifier"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="nl">"use"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"usual"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"system"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"urn:oid:2.16.840.1.113883.4.349.4.989"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"value"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"ClinicalProcedureTO.1234"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>profile in sushi</p>

<pre><code class="language-fs">* identifier[TOid].use = #usual
* identifier[TOid].system ^short = "urn:oid:2.16.840.1.113883.4.349.4.{stationNbr}"
* identifier[TOid].value ^short = "`ClinicalProcedureTO` | `.` | {ClinicalProcedureTO.id}"
</code></pre>

<h3 id="encounter-id">Encounter id</h3>

<p>Note that Encounter is more complex, and the VA CDA team have set a precedent. This because there are often multiple encounters that are spawned off of one parent, and they are all given the same id. The VA CDA team has come up with the pattern using the LOINC code in that Encounter:</p>

<p>Note that they are not using the above OID pattern for station number, they put the station number into the value. So they use the root OID  <code class="language-plaintext highlighter-rouge">urn:oid:2.16.840.1.113883.4.349</code> for system</p>

<blockquote>
  <table>
    <tbody>
      <tr>
        <td>{SectionLOINC}</td>
        <td><code class="language-plaintext highlighter-rouge">.</code></td>
        <td>{stationNbr}</td>
        <td><code class="language-plaintext highlighter-rouge">.</code></td>
        <td>{id}</td>
      </tr>
    </tbody>
  </table>
</blockquote>

<p>Note that the VA CDA does not include the id on Immunizations. From what I can tell the VA CDA does not expose any other id values.</p>

<h3 id="accession-id">Accession id</h3>

<p>Accession ID will be <code class="language-plaintext highlighter-rouge">use</code> of <code class="language-plaintext highlighter-rouge">formal</code>, and identify the <code class="language-plaintext highlighter-rouge">type</code> as <code class="language-plaintext highlighter-rouge">ACSN</code>, and the <code class="language-plaintext highlighter-rouge">value</code> will use the prefix <code class="language-plaintext highlighter-rouge">Accession</code></p>

<pre><code class="language-fs">* identifier[accessionNumber].use = #official
* identifier[accessionNumber].type = http://terminology.hl7.org/CodeSystem/v2-0203#ACSN
* identifier[accessionNumber].system ^short = "urn:oid:2.16.840.1.113883.4.349.4.{stationNbr}"
* identifier[accessionNumber].value ^short = "`Accession` | `.` | {ImagingExamTO.accessionNum}"
</code></pre>

<h3 id="case-number">Case Number</h3>

<p>Case Number will be <code class="language-plaintext highlighter-rouge">use</code> of <code class="language-plaintext highlighter-rouge">secondary</code>, and use the prefix <code class="language-plaintext highlighter-rouge">CaseNum</code></p>

<pre><code class="language-fs">* identifier[casenum].use = #secondary
* identifier[casenum].system ^short = "urn:oid:2.16.840.1.113883.4.349.4.{stationNbr}"
* identifier[casenum].value ^short = "`CaseNum` | `.` | {ImagingExam.casenum}"
</code></pre>

<h3 id="organization">Organization</h3>

<p>Organization resources are different in that they are defining a facility. So, we use the identifier.system value of the fixed OID, and the value of the station</p>

<h4 id="hospitallocationto">HospitalLocationTO</h4>

<p>HospitalLocationTO will be a <code class="language-plaintext highlighter-rouge">use</code> of <code class="language-plaintext highlighter-rouge">usual</code>, and use the prefix <code class="language-plaintext highlighter-rouge">HospitalLocationTO</code>, but will use the root OID <strong>without the station number</strong></p>

<pre><code class="language-fs">* identifier[TOid].use = #usual
* identifier[TOid].system = "urn:oid:2.16.840.1.113883.4.349"
* identifier[TOid].value = "`HospitalLocationTO` | `.` | {HospitalLocationTO.id}"
</code></pre>

<p>TODO: possibility we donâ€™t need the prefix.</p>

<h4 id="hdr-orderingfacilityidentifier">HDR orderingFacilityIdentifier</h4>

<p>orderingFacilityIdentifier will be a <code class="language-plaintext highlighter-rouge">.use</code> of <code class="language-plaintext highlighter-rouge">usual</code>, and use the fixed OID for <code class="language-plaintext highlighter-rouge">.system</code>. The orderingFacilityIdentifier has a <code class="language-plaintext highlighter-rouge">.stationNumber</code> element that we will use for the <code class="language-plaintext highlighter-rouge">.value</code>. Since we know this is the station number, we will not add a prefix.</p>

<pre><code class="language-fs">* identifier[TOid].use = #usual
* identifier[TOid].system = "urn:oid:2.16.840.1.113883.4.349"
* identifier[TOid].value ^short = "{orderingFacilityIdentifier.identity}"
</code></pre>

<h4 id="patient">Patient</h4>

<p>I donâ€™t know enough about how patient id is managed. I understand that we are just going to use the MHV assigned patient identifier and nothing more.</p>




</div>
        </div>  <!-- /inner-wrapper -->
      </div>  <!-- /row -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-content -->

  <script type="text/javascript" src="assets/js/jquery.js"> </script>     <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
  <script type="text/javascript" src="assets/js/jquery-ui.min.js"> </script>

  <script type="text/javascript">
    $(document).ready(function(){
      if(window.location.hash != "") {
          $('a[href="' + window.location.hash + '"]').click()
      }
    });
  </script>
  <a name="bottom"> </a>
  <div id="segment-footer" igtool="footer" class="segment">  <!-- segment-footer -->
    <div class="container">  <!-- container -->

      <div style="background-color:var(--footer-nav-bg-color)">
        <table style="width:100%">
          <tbody>
            <tr>
              <td style="text-align:left">&#xA0;

                <a href="ConvertDate.html">&lt;prev</a>

              </td>
              <td style="text-align:center">
                <a href="#top">top</a>
              </td>
              <td style="text-align:right">&#xA0;

                <a href="vitals.html">next&gt;</a>

              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="inner-wrapper">
        <p>
          IG &#169; 2022+ <a style="color:var(--footer-hyperlink-text-color)" href="http://healthcaresecprivacy.blogspot.com">John Moehrke (himself)</a>.  Package va.mhv.phr.example#0.1.12-beta based on <a style="color: var(--footer-hyperlink-text-color)" href="http://hl7.org/fhir/R4/">FHIR 4.0.1</a>. Generated <span title="Mon, May 1, 2023 08:16-0500">2023-05-01</span>
          <br/>
          <span style="color: var(--footer-highlight-text-color)">
                      Links: <a style="color: var(--footer-hyperlink-text-color)" href="toc.html">Table of Contents</a> |
                 <a style="color: var(--footer-hyperlink-text-color)" href="qa.html">QA Report</a>
                  | <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://github.com/JohnMoehrke/MHV-PHR/issues/new/choose">New Issue</a> | <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://github.com/JohnMoehrke/MHV-PHR/issues">Issues</a>
                
          </span>
        </p>
      </div>  <!-- /inner-wrapper -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-footer -->
  
  <div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
    <div class="container">  <!-- container -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-post-footer -->
  
  <!-- JS and analytics only. -->
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script type="text/javascript" src="assets/js/bootstrap.min.js"> </script>
  <script type="text/javascript" src="assets/js/respond.min.js"> </script>
  <script type="text/javascript" src="assets/js/anchor.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard-btn.js"> </script>
  <script>anchors.options.visible = 'hover'
anchors.add()</script>
  
<!-- feedback form - Google forms -->
<!-- v0.1, 2021-01-09 -->


  
    
  


  
    
  



<!-- / feedback form  -->

  <!-- Analytics Below
  ================================================== -->
  </body>
</html>

